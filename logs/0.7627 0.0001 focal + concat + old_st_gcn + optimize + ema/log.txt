
Starting Experiment: Advanced_HHSTF_Maxed
Using device: cuda
Dataset classes loaded from row 0: 76 classes.
Initialized dataset with 76 global classes and 848 precomputed masks.
Starting parallel preload of all tracking data & labels into RAM (Mode: train)...
Preloading Data:   0%|                                 | 0/8789 [00:00<?, ?it/s]DEBUG Mapping (File 1): Found 72/226 valid action indices using Ordinal Map.
DEBUG Mapping (File 2): Found 88/237 valid action indices using Ordinal Map.
DEBUG Mapping (File 3): Found 102/281 valid action indices using Ordinal Map.
DEBUG Mapping (File 4): Found 117/342 valid action indices using Ordinal Map.
DEBUG Mapping (File 5): Found 69/167 valid action indices using Ordinal Map.
Preloading Data: 100%|██████████████████████| 8789/8789 [02:13<00:00, 66.01it/s]
Preloaded 8789 videos and 847 label tensors.
Calculating global class frequencies for optimized loss...
Computed weights for 76 classes. Max weight: 1.13
Input Dim: 215, Num Classes: 76
Starting Standard Training (Train/Val Split)...
Dataset classes loaded from row 0: 76 classes.
Initialized dataset with 76 global classes and 848 precomputed masks.
Data already preloaded in memory. Skipping redundant preload for mode: val
Initializing model for Single Run...
Compiling model with torch.compile...
Epoch 0 [Train]:   0%|                                  | 0/315 [00:00<?, ?it/s]W0109 12:29:03.445000 1542 site-packages/torch/_inductor/utils.py:2565] [0/0] DeviceCopy in input program
Epoch 0 [Train]: 100%|█████████▉| 314/315 [01:56<00:00,  4.32it/s, loss=0.00421]W0109 12:31:01.781000 1542 site-packages/torch/_inductor/utils.py:2565] [0/1] DeviceCopy in input program
Epoch 0 [Train]: 100%|██████████| 315/315 [02:31<00:00,  2.08it/s, loss=0.00832]
Epoch 0 [Val]:   0%|                                    | 0/275 [00:00<?, ?it/s]W0109 12:31:34.648000 1542 site-packages/torch/_inductor/utils.py:2565] [0/2] DeviceCopy in input program
Epoch 0 [Val]: 100%|██████████████████████████| 275/275 [00:37<00:00,  7.41it/s]
Val Metrics - F1: 0.2669 | Precision: 0.2080 | Recall: 0.4824
Epoch 0: Train Loss = 0.0871, Val F1 = 0.2669
Epoch 1 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.35it/s, loss=0.00373]
Epoch 1 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.63it/s]
Val Metrics - F1: 0.2793 | Precision: 0.2235 | Recall: 0.4995
Epoch 1: Train Loss = 0.0042, Val F1 = 0.2793
Epoch 2 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.36it/s, loss=0.00344]
Epoch 2 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.68it/s]
Val Metrics - F1: 0.3043 | Precision: 0.2754 | Recall: 0.4840
Epoch 2: Train Loss = 0.0037, Val F1 = 0.3043
Epoch 3 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.34it/s, loss=0.00267]
Epoch 3 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.63it/s]
Val Metrics - F1: 0.2767 | Precision: 0.2258 | Recall: 0.5380
Epoch 3: Train Loss = 0.0206, Val F1 = 0.2767
Epoch 4 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.34it/s, loss=0.00207]
Epoch 4 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.68it/s]
Val Metrics - F1: 0.3011 | Precision: 0.2357 | Recall: 0.5647
Epoch 4: Train Loss = 0.0024, Val F1 = 0.3011
Epoch 5 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.34it/s, loss=0.00158]
Epoch 5 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.66it/s]
Val Metrics - F1: 0.3005 | Precision: 0.2351 | Recall: 0.5713
Epoch 5: Train Loss = 0.0020, Val F1 = 0.3005
Epoch 6 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.35it/s, loss=0.00152]
Epoch 6 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.58it/s]
Val Metrics - F1: 0.2960 | Precision: 0.2386 | Recall: 0.5846
Epoch 6: Train Loss = 0.0020, Val F1 = 0.2960
Epoch 7 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.35it/s, loss=0.00166]
Epoch 7 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.69it/s]
Val Metrics - F1: 0.3192 | Precision: 0.2440 | Recall: 0.6027
Epoch 7: Train Loss = 0.0019, Val F1 = 0.3192
Epoch 8 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.35it/s, loss=0.00153]
Epoch 8 [Val]: 100%|██████████████████████████| 275/275 [00:25<00:00, 10.66it/s]
Val Metrics - F1: 0.3167 | Precision: 0.2278 | Recall: 0.6319
Epoch 8: Train Loss = 0.0020, Val F1 = 0.3167
Epoch 9 [Train]: 100%|██████████| 315/315 [01:12<00:00,  4.36it/s, loss=0.00239]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 9 [Val]: 100%|██████████████████████████| 275/275 [00:29<00:00,  9.21it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.3247
Prediction Stats - Mean Prob: 0.002571, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 9: Train Loss = 0.0192, Val F1 = 0.2398
Epoch 10 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00187]
Epoch 10 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.41it/s]
Val Metrics - F1: 0.3191 | Precision: 0.2349 | Recall: 0.6073
Epoch 10: Train Loss = 0.0020, Val F1 = 0.3191
Epoch 11 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00139]
Epoch 11 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.3494 | Precision: 0.2603 | Recall: 0.6230
Epoch 11: Train Loss = 0.0015, Val F1 = 0.3494
Epoch 12 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000978]
Epoch 12 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.3572 | Precision: 0.2775 | Recall: 0.5885
Epoch 12: Train Loss = 0.0014, Val F1 = 0.3572
Epoch 13 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00152]
Epoch 13 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.3534 | Precision: 0.2797 | Recall: 0.5881
Epoch 13: Train Loss = 0.0014, Val F1 = 0.3534
Epoch 14 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00127]
Epoch 14 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.37it/s]
Val Metrics - F1: 0.3754 | Precision: 0.2882 | Recall: 0.6169
Epoch 14: Train Loss = 0.0014, Val F1 = 0.3754
Epoch 15 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00234]
Epoch 15 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.29it/s]
Val Metrics - F1: 0.3193 | Precision: 0.2349 | Recall: 0.6664
Epoch 15: Train Loss = 0.0015, Val F1 = 0.3193
Epoch 16 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00142]
Epoch 16 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.26it/s]
Val Metrics - F1: 0.3435 | Precision: 0.2555 | Recall: 0.6223
Epoch 16: Train Loss = 0.0014, Val F1 = 0.3435
Epoch 17 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00141]
Epoch 17 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.3402 | Precision: 0.2536 | Recall: 0.6448
Epoch 17: Train Loss = 0.0014, Val F1 = 0.3402
Epoch 18 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00148]
Epoch 18 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.38it/s]
Val Metrics - F1: 0.3541 | Precision: 0.2726 | Recall: 0.6491
Epoch 18: Train Loss = 0.0014, Val F1 = 0.3541
Epoch 19 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00129]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 19 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.50it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.4217
Prediction Stats - Mean Prob: 0.002420, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 19: Train Loss = 0.0014, Val F1 = 0.2836
Epoch 20 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00174]
Epoch 20 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.41it/s]
Val Metrics - F1: 0.3567 | Precision: 0.2599 | Recall: 0.6784
Epoch 20: Train Loss = 0.0014, Val F1 = 0.3567
Epoch 21 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00136]
Epoch 21 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.3757 | Precision: 0.2863 | Recall: 0.6568
Epoch 21: Train Loss = 0.0013, Val F1 = 0.3757
Epoch 22 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00136]
Epoch 22 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.40it/s]
Val Metrics - F1: 0.3747 | Precision: 0.2792 | Recall: 0.6850
Epoch 22: Train Loss = 0.0013, Val F1 = 0.3747
Epoch 23 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00105]
Epoch 23 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.38it/s]
Val Metrics - F1: 0.4039 | Precision: 0.3188 | Recall: 0.6328
Epoch 23: Train Loss = 0.0013, Val F1 = 0.4039
Epoch 24 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00103]
Epoch 24 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.40it/s]
Val Metrics - F1: 0.3823 | Precision: 0.2828 | Recall: 0.6794
Epoch 24: Train Loss = 0.0013, Val F1 = 0.3823
Epoch 25 [Train]: 100%|██████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.0049]
Epoch 25 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.41it/s]
Val Metrics - F1: 0.1018 | Precision: 0.0846 | Recall: 0.5687
Epoch 25: Train Loss = 0.0015, Val F1 = 0.1018
Epoch 26 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00144]
Epoch 26 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.38it/s]
Val Metrics - F1: 0.3195 | Precision: 0.2425 | Recall: 0.5911
Epoch 26: Train Loss = 0.0133, Val F1 = 0.3195
Epoch 27 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00121]
Epoch 27 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.35it/s]
Val Metrics - F1: 0.3552 | Precision: 0.2596 | Recall: 0.6396
Epoch 27: Train Loss = 0.0013, Val F1 = 0.3552
Epoch 28 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00101]
Epoch 28 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.42it/s]
Val Metrics - F1: 0.3957 | Precision: 0.3001 | Recall: 0.6472
Epoch 28: Train Loss = 0.0011, Val F1 = 0.3957
Epoch 29 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00112]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 29 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.48it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.4498
Prediction Stats - Mean Prob: 0.001783, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 29: Train Loss = 0.0010, Val F1 = 0.2939
Epoch 30 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000994]
Epoch 30 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.3684 | Precision: 0.2626 | Recall: 0.7149
Epoch 30: Train Loss = 0.0010, Val F1 = 0.3684
Epoch 31 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00129]
Epoch 31 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.3765 | Precision: 0.2695 | Recall: 0.7212
Epoch 31: Train Loss = 0.0010, Val F1 = 0.3765
Epoch 32 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000868]
Epoch 32 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.3760 | Precision: 0.2669 | Recall: 0.7132
Epoch 32: Train Loss = 0.0010, Val F1 = 0.3760
Epoch 33 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000887]
Epoch 33 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.34it/s]
Val Metrics - F1: 0.4148 | Precision: 0.3169 | Recall: 0.7136
Epoch 33: Train Loss = 0.0010, Val F1 = 0.4148
Epoch 34 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000919]
Epoch 34 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.34it/s]
Val Metrics - F1: 0.4282 | Precision: 0.3431 | Recall: 0.6712
Epoch 34: Train Loss = 0.0010, Val F1 = 0.4282
Epoch 35 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000876]
Epoch 35 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.3738 | Precision: 0.2681 | Recall: 0.7225
Epoch 35: Train Loss = 0.0011, Val F1 = 0.3738
Epoch 36 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.00107]
Epoch 36 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.3971 | Precision: 0.3059 | Recall: 0.6617
Epoch 36: Train Loss = 0.0011, Val F1 = 0.3971
Epoch 37 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000943]
Epoch 37 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.34it/s]
Val Metrics - F1: 0.4292 | Precision: 0.3283 | Recall: 0.6959
Epoch 37: Train Loss = 0.0012, Val F1 = 0.4292
Epoch 38 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000971]
Epoch 38 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.4295 | Precision: 0.3360 | Recall: 0.6893
Epoch 38: Train Loss = 0.0011, Val F1 = 0.4295
Epoch 39 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000842]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 39 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.45it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.4866
Prediction Stats - Mean Prob: 0.001369, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 39: Train Loss = 0.0010, Val F1 = 0.3125
Epoch 40 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000819]
Epoch 40 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.4372 | Precision: 0.3408 | Recall: 0.7039
Epoch 40: Train Loss = 0.0010, Val F1 = 0.4372
Epoch 41 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00117]
Epoch 41 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.4119 | Precision: 0.3035 | Recall: 0.7241
Epoch 41: Train Loss = 0.0010, Val F1 = 0.4119
Epoch 42 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000774]
Epoch 42 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.4546 | Precision: 0.3571 | Recall: 0.6940
Epoch 42: Train Loss = 0.0011, Val F1 = 0.4546
Epoch 43 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00104]
Epoch 43 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.37it/s]
Val Metrics - F1: 0.4703 | Precision: 0.3911 | Recall: 0.6777
Epoch 43: Train Loss = 0.0010, Val F1 = 0.4703
Epoch 44 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000954]
Epoch 44 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.4310 | Precision: 0.3546 | Recall: 0.6813
Epoch 44: Train Loss = 0.0009, Val F1 = 0.4310
Epoch 45 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000942]
Epoch 45 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.35it/s]
Val Metrics - F1: 0.4125 | Precision: 0.3128 | Recall: 0.7073
Epoch 45: Train Loss = 0.0010, Val F1 = 0.4125
Epoch 46 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000988]
Epoch 46 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.4297 | Precision: 0.3261 | Recall: 0.7093
Epoch 46: Train Loss = 0.0009, Val F1 = 0.4297
Epoch 47 [Train]: 100%|██████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.0012]
Epoch 47 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.37it/s]
Val Metrics - F1: 0.3970 | Precision: 0.2898 | Recall: 0.7224
Epoch 47: Train Loss = 0.0011, Val F1 = 0.3970
Epoch 48 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.000976]
Epoch 48 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.34it/s]
Val Metrics - F1: 0.4698 | Precision: 0.3618 | Recall: 0.7339
Epoch 48: Train Loss = 0.0009, Val F1 = 0.4698
Epoch 49 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00126]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 49 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.50it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.5217
Prediction Stats - Mean Prob: 0.001294, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 49: Train Loss = 0.0008, Val F1 = 0.3314
Epoch 50 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00095]
Epoch 50 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.4266 | Precision: 0.3217 | Recall: 0.6988
Epoch 50: Train Loss = 0.0010, Val F1 = 0.4266
Epoch 51 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000924]
Epoch 51 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.4464 | Precision: 0.3396 | Recall: 0.7487
Epoch 51: Train Loss = 0.0009, Val F1 = 0.4464
Epoch 52 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000781]
Epoch 52 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.37it/s]
Val Metrics - F1: 0.4845 | Precision: 0.3813 | Recall: 0.7483
Epoch 52: Train Loss = 0.0008, Val F1 = 0.4845
Epoch 53 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00079]
Epoch 53 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.29it/s]
Val Metrics - F1: 0.4898 | Precision: 0.3891 | Recall: 0.7358
Epoch 53: Train Loss = 0.0007, Val F1 = 0.4898
Epoch 54 [Train]: 100%|██████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.0012]
Epoch 54 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.4783 | Precision: 0.3699 | Recall: 0.7406
Epoch 54: Train Loss = 0.0008, Val F1 = 0.4783
Epoch 55 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000776]
Epoch 55 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.5063 | Precision: 0.4037 | Recall: 0.7285
Epoch 55: Train Loss = 0.0008, Val F1 = 0.5063
Epoch 56 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000826]
Epoch 56 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.29it/s]
Val Metrics - F1: 0.5021 | Precision: 0.4013 | Recall: 0.7465
Epoch 56: Train Loss = 0.0009, Val F1 = 0.5021
Epoch 57 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000672]
Epoch 57 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.5178 | Precision: 0.4098 | Recall: 0.7541
Epoch 57: Train Loss = 0.0007, Val F1 = 0.5178
Epoch 58 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000566]
Epoch 58 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.5378 | Precision: 0.4345 | Recall: 0.7608
Epoch 58: Train Loss = 0.0006, Val F1 = 0.5378
Epoch 59 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000929]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 59 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.38it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.5548
Prediction Stats - Mean Prob: 0.001140, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 59: Train Loss = 0.0007, Val F1 = 0.3571
Epoch 60 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000942]
Epoch 60 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.5100 | Precision: 0.4156 | Recall: 0.7426
Epoch 60: Train Loss = 0.0008, Val F1 = 0.5100
Epoch 61 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000597]
Epoch 61 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.34it/s]
Val Metrics - F1: 0.4669 | Precision: 0.3559 | Recall: 0.7782
Epoch 61: Train Loss = 0.0006, Val F1 = 0.4669
Epoch 62 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00082]
Epoch 62 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.34it/s]
Val Metrics - F1: 0.5095 | Precision: 0.4006 | Recall: 0.7661
Epoch 62: Train Loss = 0.0006, Val F1 = 0.5095
Epoch 63 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00051]
Epoch 63 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.5381 | Precision: 0.4296 | Recall: 0.7703
Epoch 63: Train Loss = 0.0006, Val F1 = 0.5381
Epoch 64 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000602]
Epoch 64 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.5396 | Precision: 0.4330 | Recall: 0.7683
Epoch 64: Train Loss = 0.0006, Val F1 = 0.5396
Epoch 65 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000633]
Epoch 65 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.35it/s]
Val Metrics - F1: 0.5395 | Precision: 0.4373 | Recall: 0.7622
Epoch 65: Train Loss = 0.0006, Val F1 = 0.5395
Epoch 66 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000533]
Epoch 66 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.39it/s]
Val Metrics - F1: 0.5592 | Precision: 0.4576 | Recall: 0.7619
Epoch 66: Train Loss = 0.0006, Val F1 = 0.5592
Epoch 67 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000468]
Epoch 67 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.5685 | Precision: 0.4619 | Recall: 0.7820
Epoch 67: Train Loss = 0.0005, Val F1 = 0.5685
Epoch 68 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000464]
Epoch 68 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.5503 | Precision: 0.4521 | Recall: 0.7595
Epoch 68: Train Loss = 0.0005, Val F1 = 0.5503
Epoch 69 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000776]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 69 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.40it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.5730
Prediction Stats - Mean Prob: 0.001117, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 69: Train Loss = 0.0006, Val F1 = 0.3706
Epoch 70 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00042]
Epoch 70 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.5801 | Precision: 0.4793 | Recall: 0.7771
Epoch 70: Train Loss = 0.0005, Val F1 = 0.5801
Epoch 71 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000341]
Epoch 71 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.5874 | Precision: 0.4827 | Recall: 0.7915
Epoch 71: Train Loss = 0.0004, Val F1 = 0.5874
Epoch 72 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000375]
Epoch 72 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.26it/s]
Val Metrics - F1: 0.5729 | Precision: 0.4733 | Recall: 0.7728
Epoch 72: Train Loss = 0.0004, Val F1 = 0.5729
Epoch 73 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000498]
Epoch 73 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.5623 | Precision: 0.4541 | Recall: 0.7857
Epoch 73: Train Loss = 0.0005, Val F1 = 0.5623
Epoch 74 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000483]
Epoch 74 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.5748 | Precision: 0.4906 | Recall: 0.7592
Epoch 74: Train Loss = 0.0006, Val F1 = 0.5748
Epoch 75 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000453]
Epoch 75 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.20it/s]
Val Metrics - F1: 0.6021 | Precision: 0.5010 | Recall: 0.7916
Epoch 75: Train Loss = 0.0005, Val F1 = 0.6021
Epoch 76 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.00039]
Epoch 76 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.6270 | Precision: 0.5330 | Recall: 0.7927
Epoch 76: Train Loss = 0.0004, Val F1 = 0.6270
Epoch 77 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00037]
Epoch 77 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.26it/s]
Val Metrics - F1: 0.5897 | Precision: 0.4882 | Recall: 0.7962
Epoch 77: Train Loss = 0.0004, Val F1 = 0.5897
Epoch 78 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000313]
Epoch 78 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.6335 | Precision: 0.5454 | Recall: 0.7903
Epoch 78: Train Loss = 0.0004, Val F1 = 0.6335
Epoch 79 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000403]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 79 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.35it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.6775
Prediction Stats - Mean Prob: 0.000575, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 79: Train Loss = 0.0004, Val F1 = 0.4386
Epoch 80 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.000633]
Epoch 80 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.5928 | Precision: 0.5150 | Recall: 0.7447
Epoch 80: Train Loss = 0.0005, Val F1 = 0.5928
Epoch 81 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000362]
Epoch 81 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.24it/s]
Val Metrics - F1: 0.6484 | Precision: 0.5645 | Recall: 0.7898
Epoch 81: Train Loss = 0.0004, Val F1 = 0.6484
Epoch 82 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000386]
Epoch 82 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.22it/s]
Val Metrics - F1: 0.5972 | Precision: 0.4924 | Recall: 0.7962
Epoch 82: Train Loss = 0.0004, Val F1 = 0.5972
Epoch 83 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000931]
Epoch 83 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.29it/s]
Val Metrics - F1: 0.4846 | Precision: 0.3756 | Recall: 0.7670
Epoch 83: Train Loss = 0.0005, Val F1 = 0.4846
Epoch 84 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000329]
Epoch 84 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.27it/s]
Val Metrics - F1: 0.6470 | Precision: 0.5573 | Recall: 0.7935
Epoch 84: Train Loss = 0.0005, Val F1 = 0.6470
Epoch 85 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.000277]
Epoch 85 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.6565 | Precision: 0.5705 | Recall: 0.7990
Epoch 85: Train Loss = 0.0003, Val F1 = 0.6565
Epoch 86 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000229]
Epoch 86 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.27it/s]
Val Metrics - F1: 0.6673 | Precision: 0.5868 | Recall: 0.7959
Epoch 86: Train Loss = 0.0003, Val F1 = 0.6673
Epoch 87 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000257]
Epoch 87 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.6669 | Precision: 0.5852 | Recall: 0.7974
Epoch 87: Train Loss = 0.0003, Val F1 = 0.6669
Epoch 88 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.00029]
Epoch 88 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.6760 | Precision: 0.6017 | Recall: 0.7925
Epoch 88: Train Loss = 0.0002, Val F1 = 0.6760
Epoch 89 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000361]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 89 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.26it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7064
Prediction Stats - Mean Prob: 0.000498, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 89: Train Loss = 0.0003, Val F1 = 0.4648
Epoch 90 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.000311]
Epoch 90 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.29it/s]
Val Metrics - F1: 0.6395 | Precision: 0.5582 | Recall: 0.7857
Epoch 90: Train Loss = 0.0003, Val F1 = 0.6395
Epoch 91 [Train]: 100%|█████████| 315/315 [01:13<00:00,  4.28it/s, loss=0.00029]
Epoch 91 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.23it/s]
Val Metrics - F1: 0.6699 | Precision: 0.5941 | Recall: 0.7879
Epoch 91: Train Loss = 0.0003, Val F1 = 0.6699
Epoch 92 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000302]
Epoch 92 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.27it/s]
Val Metrics - F1: 0.6625 | Precision: 0.5857 | Recall: 0.7954
Epoch 92: Train Loss = 0.0003, Val F1 = 0.6625
Epoch 93 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000253]
Epoch 93 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.6815 | Precision: 0.6049 | Recall: 0.7965
Epoch 93: Train Loss = 0.0002, Val F1 = 0.6815
Epoch 94 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000275]
Epoch 94 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.26it/s]
Val Metrics - F1: 0.6765 | Precision: 0.6037 | Recall: 0.7961
Epoch 94: Train Loss = 0.0002, Val F1 = 0.6765
Epoch 95 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000657]
Epoch 95 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.27it/s]
Val Metrics - F1: 0.5659 | Precision: 0.4648 | Recall: 0.7764
Epoch 95: Train Loss = 0.0003, Val F1 = 0.5659
Epoch 96 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000296]
Epoch 96 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.22it/s]
Val Metrics - F1: 0.6553 | Precision: 0.5708 | Recall: 0.7972
Epoch 96: Train Loss = 0.0005, Val F1 = 0.6553
Epoch 97 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000232]
Epoch 97 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.33it/s]
Val Metrics - F1: 0.6940 | Precision: 0.6202 | Recall: 0.8010
Epoch 97: Train Loss = 0.0002, Val F1 = 0.6940
Epoch 98 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000169]
Epoch 98 [Val]: 100%|█████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.7000 | Precision: 0.6306 | Recall: 0.8026
Epoch 98: Train Loss = 0.0002, Val F1 = 0.7000
Epoch 99 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000216]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 99 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.36it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7256
Prediction Stats - Mean Prob: 0.000437, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 99: Train Loss = 0.0002, Val F1 = 0.4812
Epoch 100 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000186]
Epoch 100 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.7080 | Precision: 0.6430 | Recall: 0.8017
Epoch 100: Train Loss = 0.0002, Val F1 = 0.7080
Epoch 101 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000195]
Epoch 101 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.25it/s]
Val Metrics - F1: 0.7033 | Precision: 0.6359 | Recall: 0.8013
Epoch 101: Train Loss = 0.0002, Val F1 = 0.7033
Epoch 102 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00019]
Epoch 102 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.29it/s]
Val Metrics - F1: 0.6938 | Precision: 0.6223 | Recall: 0.8034
Epoch 102: Train Loss = 0.0002, Val F1 = 0.6938
Epoch 103 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000284]
Epoch 103 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.21it/s]
Val Metrics - F1: 0.6909 | Precision: 0.6184 | Recall: 0.7986
Epoch 103: Train Loss = 0.0002, Val F1 = 0.6909
Epoch 104 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.28it/s, loss=0.000408]
Epoch 104 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.5985 | Precision: 0.5025 | Recall: 0.7880
Epoch 104: Train Loss = 0.0003, Val F1 = 0.5985
Epoch 105 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000204]
Epoch 105 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.28it/s]
Val Metrics - F1: 0.7005 | Precision: 0.6345 | Recall: 0.7992
Epoch 105: Train Loss = 0.0003, Val F1 = 0.7005
Epoch 106 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=0.00018]
Epoch 106 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.7160 | Precision: 0.6542 | Recall: 0.8020
Epoch 106: Train Loss = 0.0002, Val F1 = 0.7160
Epoch 107 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000155]
Epoch 107 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.7179 | Precision: 0.6587 | Recall: 0.8027
Epoch 107: Train Loss = 0.0002, Val F1 = 0.7179
Epoch 108 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000171]
Epoch 108 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.7034 | Precision: 0.6408 | Recall: 0.8040
Epoch 108: Train Loss = 0.0002, Val F1 = 0.7034
Epoch 109 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000152]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 109 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.40it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7384
Prediction Stats - Mean Prob: 0.000398, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 109: Train Loss = 0.0002, Val F1 = 0.4907
Epoch 110 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000189]
Epoch 110 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.40it/s]
Val Metrics - F1: 0.7146 | Precision: 0.6525 | Recall: 0.8023
Epoch 110: Train Loss = 0.0002, Val F1 = 0.7146
Epoch 111 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.31it/s, loss=0.000101]
Epoch 111 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.7267 | Precision: 0.6701 | Recall: 0.8030
Epoch 111: Train Loss = 0.0002, Val F1 = 0.7267
Epoch 112 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000159]
Epoch 112 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.7244 | Precision: 0.6665 | Recall: 0.8028
Epoch 112: Train Loss = 0.0001, Val F1 = 0.7244
Epoch 113 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000168]
Epoch 113 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.41it/s]
Val Metrics - F1: 0.7204 | Precision: 0.6604 | Recall: 0.8041
Epoch 113: Train Loss = 0.0001, Val F1 = 0.7204
Epoch 114 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.31it/s, loss=0.000188]
Epoch 114 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.42it/s]
Val Metrics - F1: 0.7034 | Precision: 0.6402 | Recall: 0.8002
Epoch 114: Train Loss = 0.0002, Val F1 = 0.7034
Epoch 115 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.31it/s, loss=0.000206]
Epoch 115 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.39it/s]
Val Metrics - F1: 0.7137 | Precision: 0.6524 | Recall: 0.8021
Epoch 115: Train Loss = 0.0002, Val F1 = 0.7137
Epoch 116 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00018]
Epoch 116 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.44it/s]
Val Metrics - F1: 0.7089 | Precision: 0.6438 | Recall: 0.8026
Epoch 116: Train Loss = 0.0001, Val F1 = 0.7089
Epoch 117 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.31it/s, loss=0.00016]
Epoch 117 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.41it/s]
Val Metrics - F1: 0.7267 | Precision: 0.6710 | Recall: 0.8038
Epoch 117: Train Loss = 0.0001, Val F1 = 0.7267
Epoch 118 [Train]: 100%|███████| 315/315 [01:12<00:00,  4.32it/s, loss=0.000145]
Epoch 118 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.37it/s]
Val Metrics - F1: 0.7275 | Precision: 0.6711 | Recall: 0.8034
Epoch 118: Train Loss = 0.0001, Val F1 = 0.7275
Epoch 119 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.31it/s, loss=0.000106]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 119 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.52it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7564
Prediction Stats - Mean Prob: 0.000364, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 119: Train Loss = 0.0002, Val F1 = 0.5045
Epoch 120 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000149]
Epoch 120 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.7369 | Precision: 0.6891 | Recall: 0.8034
Epoch 120: Train Loss = 0.0001, Val F1 = 0.7369
Epoch 121 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000112]
Epoch 121 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.36it/s]
Val Metrics - F1: 0.7384 | Precision: 0.6890 | Recall: 0.8039
Epoch 121: Train Loss = 0.0001, Val F1 = 0.7384
Epoch 122 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000148]
Epoch 122 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.7290 | Precision: 0.6750 | Recall: 0.8030
Epoch 122: Train Loss = 0.0001, Val F1 = 0.7290
Epoch 123 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000112]
Epoch 123 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.35it/s]
Val Metrics - F1: 0.7453 | Precision: 0.7001 | Recall: 0.8040
Epoch 123: Train Loss = 0.0001, Val F1 = 0.7453
Epoch 124 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000112]
Epoch 124 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.30it/s]
Val Metrics - F1: 0.7383 | Precision: 0.6899 | Recall: 0.8047
Epoch 124: Train Loss = 0.0001, Val F1 = 0.7383
Epoch 125 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.29it/s, loss=9.14e-5]
Epoch 125 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.32it/s]
Val Metrics - F1: 0.7400 | Precision: 0.6901 | Recall: 0.8045
Epoch 125: Train Loss = 0.0001, Val F1 = 0.7400
Epoch 126 [Train]: 100%|████████| 315/315 [01:13<00:00,  4.30it/s, loss=0.00012]
Epoch 126 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.7480 | Precision: 0.7037 | Recall: 0.8048
Epoch 126: Train Loss = 0.0001, Val F1 = 0.7480
Epoch 127 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000133]
Epoch 127 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.31it/s]
Val Metrics - F1: 0.7408 | Precision: 0.6921 | Recall: 0.8041
Epoch 127: Train Loss = 0.0001, Val F1 = 0.7408
Epoch 128 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.30it/s, loss=0.000123]
Epoch 128 [Val]: 100%|████████████████████████| 275/275 [00:26<00:00, 10.37it/s]
Val Metrics - F1: 0.7485 | Precision: 0.7040 | Recall: 0.8053
Epoch 128: Train Loss = 0.0001, Val F1 = 0.7485
Epoch 129 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000102]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 129 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.51it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7653
Prediction Stats - Mean Prob: 0.000340, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 129: Train Loss = 0.0001, Val F1 = 0.5138
Epoch 130 [Train]: 100%|███████| 315/315 [01:13<00:00,  4.29it/s, loss=0.000102]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 130 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.42it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7627
Prediction Stats - Mean Prob: 0.000350, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 130: Train Loss = 0.0001, Val F1 = 0.5116
Early stopping: Train loss 0.000100 reached threshold 0.0001

