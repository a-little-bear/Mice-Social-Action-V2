
Starting Experiment: Advanced_HHSTF_Maxed
Using device: cuda
Starting parallel preload of all tracking data into RAM (Mode: train)...
Preloading Videos & Annotations: 100%|██████████| 8789/8789 [02:00<00:00, 73.03it/s]
Preloaded 8789 videos and 847 annotations into RAM.
Input Dim: 215, Num Classes: 76
Starting Standard Training (Train/Val Split)...
Data already preloaded in memory. Skipping redundant preload for mode: val
Initializing model for Single Run...
Compiling model with torch.compile...
Epoch 0 [Train]: 100%|██████████████| 315/315 [00:42<00:00,  7.36it/s, loss=0.00728]
Epoch 0 [Val]: 100%|██████████████████████████████| 275/275 [00:51<00:00,  5.32it/s]
Epoch 0: Train Loss = 0.0274, Val F1 = 0.0077
Epoch 1 [Train]: 100%|██████████████| 315/315 [00:24<00:00, 12.94it/s, loss=0.00519]
Epoch 1 [Val]: 100%|██████████████████████████████| 275/275 [00:48<00:00,  5.65it/s]
Epoch 1: Train Loss = 0.0074, Val F1 = 0.0101
Epoch 2 [Train]: 100%|██████████████| 315/315 [00:24<00:00, 13.12it/s, loss=0.00581]
Epoch 2 [Val]: 100%|██████████████████████████████| 275/275 [00:47<00:00,  5.73it/s]
Epoch 2: Train Loss = 0.0066, Val F1 = 0.0102
Epoch 3 [Train]: 100%|██████████████| 315/315 [00:24<00:00, 12.93it/s, loss=0.00758]
Epoch 3 [Val]: 100%|██████████████████████████████| 275/275 [00:49<00:00,  5.53it/s]
Epoch 3: Train Loss = 0.0063, Val F1 = 0.0110
Epoch 4 [Train]: 100%|██████████████| 315/315 [00:24<00:00, 13.08it/s, loss=0.00677]
Epoch 4 [Val]: 100%|██████████████████████████████| 275/275 [00:46<00:00,  5.88it/s]
Epoch 4: Train Loss = 0.0060, Val F1 = 0.0121
Epoch 5 [Train]: 100%|██████████████| 315/315 [00:24<00:00, 12.89it/s, loss=0.00556]
Epoch 5 [Val]: 100%|██████████████████████████████| 275/275 [00:48<00:00,  5.66it/s]
Epoch 5: Train Loss = 0.0058, Val F1 = 0.0116
Epoch 6 [Train]: 100%|██████████████| 315/315 [00:23<00:00, 13.17it/s, loss=0.00472]
Epoch 6 [Val]: 100%|██████████████████████████████| 275/275 [00:52<00:00,  5.22it/s]
Epoch 6: Train Loss = 0.0056, Val F1 = 0.0121
Epoch 7 [Train]: 100%|██████████████| 315/315 [00:24<00:00, 13.07it/s, loss=0.00446]
Epoch 7 [Val]: 100%|██████████████████████████████| 275/275 [00:55<00:00,  5.00it/s]
Epoch 7: Train Loss = 0.0055, Val F1 = 0.0123
Epoch 8 [Train]: 100%|██████████████| 315/315 [00:23<00:00, 13.29it/s, loss=0.00496]
Epoch 8 [Val]: 100%|██████████████████████████████| 275/275 [00:52<00:00,  5.19it/s]
Epoch 8: Train Loss = 0.0054, Val F1 = 0.0135
Epoch 9 [Train]: 100%|██████████████| 315/315 [00:25<00:00, 12.29it/s, loss=0.00474]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 9 [Val]: 100%|██████████████████████████████| 275/275 [00:21<00:00, 13.06it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
[Post-Processing] Applying smoothing to full validation set...
Applying temporal smoothing (method: ema) in-place...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.0160
Prediction Stats - Mean Prob: 0.001184, Max Prob: 1.000000
Applying tie-breaking (method: kaggle) using 8 jobs...
Calculating F1 scores using 8 jobs...
Epoch 9: Train Loss = 0.0054, Val F1 = 0.3766
Epoch 10 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.93it/s, loss=0.00512]
Epoch 10 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.34it/s]
Epoch 10: Train Loss = 0.0052, Val F1 = 0.0128
Epoch 11 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.99it/s, loss=0.00548]
Epoch 11 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.42it/s]
Epoch 11: Train Loss = 0.0052, Val F1 = 0.0126
Epoch 12 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.15it/s, loss=0.00519]
Epoch 12 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.23it/s]
Epoch 12: Train Loss = 0.0051, Val F1 = 0.0129
Epoch 13 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.76it/s, loss=0.00524]
Epoch 13 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.34it/s]
Epoch 13: Train Loss = 0.0050, Val F1 = 0.0138
Epoch 14 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.15it/s, loss=0.00449]
Epoch 14 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.42it/s]
Epoch 14: Train Loss = 0.0049, Val F1 = 0.0150
Epoch 15 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 12.07it/s, loss=0.00504]
Epoch 15 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.31it/s]
Epoch 15: Train Loss = 0.0048, Val F1 = 0.0144
Epoch 16 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.99it/s, loss=0.00493]
Epoch 16 [Val]: 100%|█████████████████████████████| 275/275 [00:37<00:00,  7.32it/s]
Epoch 16: Train Loss = 0.0046, Val F1 = 0.0162
Epoch 17 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.77it/s, loss=0.00403]
Epoch 17 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.20it/s]
Epoch 17: Train Loss = 0.0044, Val F1 = 0.0150
Epoch 18 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 12.04it/s, loss=0.00433]
Epoch 18 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Epoch 18: Train Loss = 0.0042, Val F1 = 0.0175
Epoch 19 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.14it/s, loss=0.00385]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 19 [Val]: 100%|█████████████████████████████| 275/275 [00:23<00:00, 11.54it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
[Post-Processing] Applying smoothing to full validation set...
Applying temporal smoothing (method: ema) in-place...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.0214
Prediction Stats - Mean Prob: 0.000875, Max Prob: 1.000000
Applying tie-breaking (method: kaggle) using 8 jobs...
Calculating F1 scores using 8 jobs...
Epoch 19: Train Loss = 0.0041, Val F1 = 0.4331
Epoch 20 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.28it/s, loss=0.00514]
Epoch 20 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.29it/s]
Epoch 20: Train Loss = 0.0040, Val F1 = 0.0170
Epoch 21 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.27it/s, loss=0.00447]
Epoch 21 [Val]: 100%|█████████████████████████████| 275/275 [00:31<00:00,  8.65it/s]
Epoch 21: Train Loss = 0.0038, Val F1 = 0.0197
Epoch 22 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.34it/s, loss=0.00331]
Epoch 22 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.46it/s]
Epoch 22: Train Loss = 0.0037, Val F1 = 0.0198
Epoch 23 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 12.08it/s, loss=0.00342]
Epoch 23 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.53it/s]
Epoch 23: Train Loss = 0.0034, Val F1 = 0.0201
Epoch 24 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.39it/s, loss=0.00313]
Epoch 24 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.50it/s]
Epoch 24: Train Loss = 0.0033, Val F1 = 0.0207
Epoch 25 [Train]: 100%|█████████████| 315/315 [00:27<00:00, 11.67it/s, loss=0.00327]
Epoch 25 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.57it/s]
Epoch 25: Train Loss = 0.0032, Val F1 = 0.0216
Epoch 26 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.24it/s, loss=0.00284]
Epoch 26 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.15it/s]
Epoch 26: Train Loss = 0.0029, Val F1 = 0.0227
Epoch 27 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.21it/s, loss=0.00307]
Epoch 27 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.48it/s]
Epoch 27: Train Loss = 0.0028, Val F1 = 0.0248
Epoch 28 [Train]: 100%|█████████████| 315/315 [00:25<00:00, 12.32it/s, loss=0.00269]
Epoch 28 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.18it/s]
Epoch 28: Train Loss = 0.0026, Val F1 = 0.0254
Epoch 29 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 12.07it/s, loss=0.00224]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 29 [Val]: 100%|█████████████████████████████| 275/275 [00:31<00:00,  8.73it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
[Post-Processing] Applying smoothing to full validation set...
Applying temporal smoothing (method: ema) in-place...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.0295
Prediction Stats - Mean Prob: 0.000640, Max Prob: 1.000000
Applying tie-breaking (method: kaggle) using 8 jobs...
Calculating F1 scores using 8 jobs...
Epoch 29: Train Loss = 0.0025, Val F1 = 0.5412
Epoch 30 [Train]: 100%|█████████████| 315/315 [00:27<00:00, 11.62it/s, loss=0.00263]
Epoch 30 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.81it/s]
Epoch 30: Train Loss = 0.0024, Val F1 = 0.0258
Epoch 31 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.80it/s, loss=0.00228]
Epoch 31 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  8.00it/s]
Epoch 31: Train Loss = 0.0022, Val F1 = 0.0274
Epoch 32 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.94it/s, loss=0.00176]
Epoch 32 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  8.07it/s]
Epoch 32: Train Loss = 0.0021, Val F1 = 0.0276
Epoch 33 [Train]: 100%|█████████████| 315/315 [00:27<00:00, 11.60it/s, loss=0.00203]
Epoch 33 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.80it/s]
Epoch 33: Train Loss = 0.0019, Val F1 = 0.0288
Epoch 34 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.73it/s, loss=0.00196]
Epoch 34 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  8.00it/s]
Epoch 34: Train Loss = 0.0018, Val F1 = 0.0293
Epoch 35 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.70it/s, loss=0.00198]
Epoch 35 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.72it/s]
Epoch 35: Train Loss = 0.0017, Val F1 = 0.0301
Epoch 36 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.67it/s, loss=0.00152]
Epoch 36 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  7.99it/s]
Epoch 36: Train Loss = 0.0016, Val F1 = 0.0311
Epoch 37 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.72it/s, loss=0.00143]
Epoch 37 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  7.96it/s]
Epoch 37: Train Loss = 0.0015, Val F1 = 0.0315
Epoch 38 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.74it/s, loss=0.00123]
Epoch 38 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.12it/s]
Epoch 38: Train Loss = 0.0015, Val F1 = 0.0317
Epoch 39 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.73it/s, loss=0.00167]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 39 [Val]: 100%|█████████████████████████████| 275/275 [00:32<00:00,  8.45it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
[Post-Processing] Applying smoothing to full validation set...
Applying temporal smoothing (method: ema) in-place...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.0363
Prediction Stats - Mean Prob: 0.000468, Max Prob: 1.000000
Applying tie-breaking (method: kaggle) using 8 jobs...
Calculating F1 scores using 8 jobs...
Epoch 39: Train Loss = 0.0014, Val F1 = 0.6349
Epoch 40 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 12.00it/s, loss=0.00138]
Epoch 40 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.76it/s]
Epoch 40: Train Loss = 0.0013, Val F1 = 0.0333
Epoch 41 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.76it/s, loss=0.00133]
Epoch 41 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  7.91it/s]
Epoch 41: Train Loss = 0.0013, Val F1 = 0.0336
Epoch 42 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.91it/s, loss=0.00141]
Epoch 42 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.77it/s]
Epoch 42: Train Loss = 0.0012, Val F1 = 0.0338
Epoch 43 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 12.09it/s, loss=0.00122]
Epoch 43 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  8.06it/s]
Epoch 43: Train Loss = 0.0012, Val F1 = 0.0341
Epoch 44 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.89it/s, loss=0.00114]
Epoch 44 [Val]: 100%|█████████████████████████████| 275/275 [00:34<00:00,  7.96it/s]
Epoch 44: Train Loss = 0.0012, Val F1 = 0.0342
Epoch 45 [Train]: 100%|██████████████| 315/315 [00:26<00:00, 11.80it/s, loss=0.0011]
Epoch 45 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.81it/s]
Epoch 45: Train Loss = 0.0012, Val F1 = 0.0346
Epoch 46 [Train]: 100%|█████████████| 315/315 [00:26<00:00, 11.95it/s, loss=0.00129]
Epoch 46 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.84it/s]
Epoch 46: Train Loss = 0.0011, Val F1 = 0.0347
Epoch 47 [Train]: 100%|█████████████| 315/315 [00:27<00:00, 11.62it/s, loss=0.00129]
Epoch 47 [Val]: 100%|█████████████████████████████| 275/275 [00:35<00:00,  7.75it/s]
Epoch 47: Train Loss = 0.0011, Val F1 = 0.0348
Epoch 48 [Train]: 100%|█████████████| 315/315 [00:27<00:00, 11.58it/s, loss=0.00105]
Epoch 48 [Val]: 100%|█████████████████████████████| 275/275 [00:33<00:00,  8.17it/s]
Epoch 48: Train Loss = 0.0011, Val F1 = 0.0349
Epoch 49 [Train]: 100%|██████████████| 315/315 [00:26<00:00, 11.84it/s, loss=0.0011]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 49 [Val]: 100%|█████████████████████████████| 275/275 [00:28<00:00,  9.57it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
[Post-Processing] Applying smoothing to full validation set...
Applying temporal smoothing (method: ema) in-place...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.0379
Prediction Stats - Mean Prob: 0.000429, Max Prob: 1.000000
Applying tie-breaking (method: kaggle) using 8 jobs...
Calculating F1 scores using 8 jobs...
Epoch 49: Train Loss = 0.0011, Val F1 = 0.6556

