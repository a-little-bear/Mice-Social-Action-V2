
Preloading Data:   0%|                                 | 0/8789 [00:00<?, ?it/s]DEBUG Mapping (File 1): Found 72/226 valid action indices using Ordinal Map.
DEBUG Mapping (File 2): Found 88/237 valid action indices using Ordinal Map.
DEBUG Mapping (File 3): Found 85/214 valid action indices using Ordinal Map.
DEBUG Mapping (File 4): Found 102/281 valid action indices using Ordinal Map.
DEBUG Mapping (File 5): Found 78/213 valid action indices using Ordinal Map.
Preloading Data: 100%|██████████████████████| 8789/8789 [02:12<00:00, 66.46it/s]
Preloaded 8789 videos and 847 label tensors.
Calculating global class frequencies for optimized loss...
Computed weights for 76 classes. Max weight: 1.13
Input Dim: 215, Num Classes: 76
Starting Standard Training (Train/Val Split)...
Dataset classes loaded from row 0: 76 classes.
Initialized dataset with 76 global classes and 848 precomputed masks.
Data already preloaded in memory. Skipping redundant preload for mode: val
Initializing model for Single Run...
Compiling model with torch.compile...
Epoch 0 [Train]:   0%|                                  | 0/315 [00:00<?, ?it/s]W0109 12:35:25.453000 1525 site-packages/torch/_inductor/utils.py:2565] [0/0] DeviceCopy in input program
/root/miniconda3/envs/jit/lib/python3.10/site-packages/torch/_inductor/lowering.py:7644: UserWarning:
Online softmax is disabled on the fly since Inductor decides to
split the reduction. Cut an issue to PyTorch if this is an
important use case and you want to speed it up with online
softmax.

  warnings.warn(
Epoch 0 [Train]: 100%|█████████▉| 314/315 [01:56<00:00,  4.02it/s, loss=0.00572]W0109 12:37:24.195000 1525 site-packages/torch/_inductor/utils.py:2565] [0/1] DeviceCopy in input program
/root/miniconda3/envs/jit/lib/python3.10/site-packages/torch/_inductor/lowering.py:7644: UserWarning:
Online softmax is disabled on the fly since Inductor decides to
split the reduction. Cut an issue to PyTorch if this is an
important use case and you want to speed it up with online
softmax.

  warnings.warn(
Epoch 0 [Train]: 100%|██████████| 315/315 [02:26<00:00,  2.15it/s, loss=0.00418]
Epoch 0 [Val]:   0%|                                    | 0/275 [00:00<?, ?it/s]W0109 12:37:51.779000 1525 site-packages/torch/_inductor/utils.py:2565] [0/2] DeviceCopy in input program
/root/miniconda3/envs/jit/lib/python3.10/site-packages/torch/_inductor/lowering.py:7644: UserWarning:
Online softmax is disabled on the fly since Inductor decides to
split the reduction. Cut an issue to PyTorch if this is an
important use case and you want to speed it up with online
softmax.

  warnings.warn(
Epoch 0 [Val]: 100%|██████████████████████████| 275/275 [00:41<00:00,  6.64it/s]
Val Metrics - F1: 0.2552 | Precision: 0.2552 | Recall: 0.4421
Epoch 0: Train Loss = 0.1160, Val F1 = 0.2552
Epoch 1 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.22it/s, loss=0.00347]
Epoch 1 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.68it/s]
Val Metrics - F1: 0.2743 | Precision: 0.1989 | Recall: 0.5678
Epoch 1: Train Loss = 0.0044, Val F1 = 0.2743
Epoch 2 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.21it/s, loss=0.00854]
Epoch 2 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.72it/s]
Val Metrics - F1: 0.2478 | Precision: 0.1891 | Recall: 0.4712
Epoch 2: Train Loss = 0.0145, Val F1 = 0.2478
Epoch 3 [Train]: 100%|███████████| 315/315 [01:14<00:00,  4.21it/s, loss=0.0039]
Epoch 3 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.74it/s]
Val Metrics - F1: 0.2729 | Precision: 0.2086 | Recall: 0.5563
Epoch 3: Train Loss = 0.0035, Val F1 = 0.2729
Epoch 4 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.21it/s, loss=0.00183]
Epoch 4 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.69it/s]
Val Metrics - F1: 0.3089 | Precision: 0.2279 | Recall: 0.5844
Epoch 4: Train Loss = 0.0023, Val F1 = 0.3089
Epoch 5 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.20it/s, loss=0.00155]
Epoch 5 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.68it/s]
Val Metrics - F1: 0.3244 | Precision: 0.2464 | Recall: 0.5900
Epoch 5: Train Loss = 0.0020, Val F1 = 0.3244
Epoch 6 [Train]: 100%|███████████| 315/315 [01:14<00:00,  4.20it/s, loss=0.0024]
Epoch 6 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.73it/s]
Val Metrics - F1: 0.3393 | Precision: 0.2643 | Recall: 0.5750
Epoch 6: Train Loss = 0.0020, Val F1 = 0.3393
Epoch 7 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.21it/s, loss=0.00317]
Epoch 7 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.74it/s]
Val Metrics - F1: 0.2957 | Precision: 0.2136 | Recall: 0.6533
Epoch 7: Train Loss = 0.0027, Val F1 = 0.2957
Epoch 8 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.21it/s, loss=0.00188]
Epoch 8 [Val]: 100%|██████████████████████████| 275/275 [00:31<00:00,  8.74it/s]
Val Metrics - F1: 0.3406 | Precision: 0.2619 | Recall: 0.6131
Epoch 8: Train Loss = 0.0022, Val F1 = 0.3406
Epoch 9 [Train]: 100%|██████████| 315/315 [01:14<00:00,  4.22it/s, loss=0.00166]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 9 [Val]: 100%|██████████████████████████| 275/275 [00:35<00:00,  7.77it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.3661
Prediction Stats - Mean Prob: 0.002090, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 9: Train Loss = 0.0020, Val F1 = 0.2576
Epoch 10 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.14it/s, loss=0.00703]
Epoch 10 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.47it/s]
Val Metrics - F1: 0.2324 | Precision: 0.1778 | Recall: 0.4998
Epoch 10: Train Loss = 0.0251, Val F1 = 0.2324
Epoch 11 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00199]
Epoch 11 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.48it/s]
Val Metrics - F1: 0.3137 | Precision: 0.2919 | Recall: 0.4909
Epoch 11: Train Loss = 0.0031, Val F1 = 0.3137
Epoch 12 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00138]
Epoch 12 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.44it/s]
Val Metrics - F1: 0.2930 | Precision: 0.2227 | Recall: 0.6301
Epoch 12: Train Loss = 0.0017, Val F1 = 0.2930
Epoch 13 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00179]
Epoch 13 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.49it/s]
Val Metrics - F1: 0.3533 | Precision: 0.2830 | Recall: 0.5887
Epoch 13: Train Loss = 0.0015, Val F1 = 0.3533
Epoch 14 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00108]
Epoch 14 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.18it/s]
Val Metrics - F1: 0.3526 | Precision: 0.2627 | Recall: 0.6420
Epoch 14: Train Loss = 0.0014, Val F1 = 0.3526
Epoch 15 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00125]
Epoch 15 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.32it/s]
Val Metrics - F1: 0.3391 | Precision: 0.2540 | Recall: 0.6347
Epoch 15: Train Loss = 0.0014, Val F1 = 0.3391
Epoch 16 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00148]
Epoch 16 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.3447 | Precision: 0.2552 | Recall: 0.6442
Epoch 16: Train Loss = 0.0013, Val F1 = 0.3447
Epoch 17 [Train]: 100%|██████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.0017]
Epoch 17 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.41it/s]
Val Metrics - F1: 0.3326 | Precision: 0.2642 | Recall: 0.5870
Epoch 17: Train Loss = 0.0015, Val F1 = 0.3326
Epoch 18 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00238]
Epoch 18 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.22it/s]
Val Metrics - F1: 0.3060 | Precision: 0.2222 | Recall: 0.6843
Epoch 18: Train Loss = 0.0016, Val F1 = 0.3060
Epoch 19 [Train]: 100%|██████████| 315/315 [01:17<00:00,  4.09it/s, loss=0.0013]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 19 [Val]: 100%|█████████████████████████| 275/275 [00:40<00:00,  6.73it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.4047
Prediction Stats - Mean Prob: 0.002283, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 19: Train Loss = 0.0015, Val F1 = 0.2711
Epoch 20 [Train]: 100%|██████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.0013]
Epoch 20 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.3735 | Precision: 0.2811 | Recall: 0.6450
Epoch 20: Train Loss = 0.0013, Val F1 = 0.3735
Epoch 21 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00103]
Epoch 21 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.36it/s]
Val Metrics - F1: 0.3737 | Precision: 0.2772 | Recall: 0.6517
Epoch 21: Train Loss = 0.0013, Val F1 = 0.3737
Epoch 22 [Train]: 100%|██████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.0015]
Epoch 22 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.32it/s]
Val Metrics - F1: 0.3652 | Precision: 0.2827 | Recall: 0.6590
Epoch 22: Train Loss = 0.0012, Val F1 = 0.3652
Epoch 23 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00388]
Epoch 23 [Val]: 100%|█████████████████████████| 275/275 [00:32<00:00,  8.34it/s]
Val Metrics - F1: 0.3462 | Precision: 0.2870 | Recall: 0.5522
Epoch 23: Train Loss = 0.0013, Val F1 = 0.3462
Epoch 24 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00148]
Epoch 24 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.16it/s]
Val Metrics - F1: 0.3591 | Precision: 0.2711 | Recall: 0.6264
Epoch 24: Train Loss = 0.0016, Val F1 = 0.3591
Epoch 25 [Train]: 100%|██████████| 315/315 [01:16<00:00,  4.09it/s, loss=0.0012]
Epoch 25 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.16it/s]
Val Metrics - F1: 0.3601 | Precision: 0.2646 | Recall: 0.6533
Epoch 25: Train Loss = 0.0013, Val F1 = 0.3601
Epoch 26 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.09it/s, loss=0.00124]
Epoch 26 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.18it/s]
Val Metrics - F1: 0.3232 | Precision: 0.2264 | Recall: 0.7157
Epoch 26: Train Loss = 0.0012, Val F1 = 0.3232
Epoch 27 [Train]: 100%|████████| 315/315 [01:17<00:00,  4.06it/s, loss=0.000934]
Epoch 27 [Val]: 100%|█████████████████████████| 275/275 [00:34<00:00,  8.00it/s]
Val Metrics - F1: 0.3794 | Precision: 0.2956 | Recall: 0.6659
Epoch 27: Train Loss = 0.0012, Val F1 = 0.3794
Epoch 28 [Train]: 100%|█████████| 315/315 [01:17<00:00,  4.06it/s, loss=0.00136]
Epoch 28 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.19it/s]
Val Metrics - F1: 0.3884 | Precision: 0.3015 | Recall: 0.6635
Epoch 28: Train Loss = 0.0013, Val F1 = 0.3884
Epoch 29 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.00145]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 29 [Val]: 100%|█████████████████████████| 275/275 [00:47<00:00,  5.82it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.4425
Prediction Stats - Mean Prob: 0.001830, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 29: Train Loss = 0.0012, Val F1 = 0.2929
Epoch 30 [Train]: 100%|█████████| 315/315 [01:17<00:00,  4.07it/s, loss=0.00109]
Epoch 30 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.18it/s]
Val Metrics - F1: 0.3959 | Precision: 0.3049 | Recall: 0.6556
Epoch 30: Train Loss = 0.0013, Val F1 = 0.3959
Epoch 31 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.09it/s, loss=0.00107]
Epoch 31 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.16it/s]
Val Metrics - F1: 0.3737 | Precision: 0.2840 | Recall: 0.6713
Epoch 31: Train Loss = 0.0012, Val F1 = 0.3737
Epoch 32 [Train]: 100%|████████| 315/315 [01:17<00:00,  4.09it/s, loss=0.000992]
Epoch 32 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.14it/s]
Val Metrics - F1: 0.4346 | Precision: 0.3462 | Recall: 0.6466
Epoch 32: Train Loss = 0.0011, Val F1 = 0.4346
Epoch 33 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.09it/s, loss=0.00132]
Epoch 33 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.09it/s]
Val Metrics - F1: 0.3705 | Precision: 0.2683 | Recall: 0.7125
Epoch 33: Train Loss = 0.0011, Val F1 = 0.3705
Epoch 34 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.09it/s, loss=0.00196]
Epoch 34 [Val]: 100%|█████████████████████████| 275/275 [00:34<00:00,  8.06it/s]
Val Metrics - F1: 0.3676 | Precision: 0.2660 | Recall: 0.7095
Epoch 34: Train Loss = 0.0012, Val F1 = 0.3676
Epoch 35 [Train]: 100%|█████████| 315/315 [01:17<00:00,  4.09it/s, loss=0.00137]
Epoch 35 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.21it/s]
Val Metrics - F1: 0.4228 | Precision: 0.3338 | Recall: 0.6888
Epoch 35: Train Loss = 0.0011, Val F1 = 0.4228
Epoch 36 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.00109]
Epoch 36 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.26it/s]
Val Metrics - F1: 0.3734 | Precision: 0.2751 | Recall: 0.6957
Epoch 36: Train Loss = 0.0011, Val F1 = 0.3734
Epoch 37 [Train]: 100%|████████| 315/315 [01:17<00:00,  4.09it/s, loss=0.000955]
Epoch 37 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.17it/s]
Val Metrics - F1: 0.4075 | Precision: 0.3077 | Recall: 0.7146
Epoch 37: Train Loss = 0.0010, Val F1 = 0.4075
Epoch 38 [Train]: 100%|█████████| 315/315 [01:17<00:00,  4.08it/s, loss=0.00103]
Epoch 38 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.11it/s]
Val Metrics - F1: 0.4274 | Precision: 0.3353 | Recall: 0.6483
Epoch 38: Train Loss = 0.0010, Val F1 = 0.4274
Epoch 39 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.00126]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 39 [Val]: 100%|█████████████████████████| 275/275 [00:41<00:00,  6.69it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.4924
Prediction Stats - Mean Prob: 0.001367, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 39: Train Loss = 0.0010, Val F1 = 0.3127
Epoch 40 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00118]
Epoch 40 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.15it/s]
Val Metrics - F1: 0.4295 | Precision: 0.3593 | Recall: 0.6487
Epoch 40: Train Loss = 0.0010, Val F1 = 0.4295
Epoch 41 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.00128]
Epoch 41 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.14it/s]
Val Metrics - F1: 0.3717 | Precision: 0.2681 | Recall: 0.7162
Epoch 41: Train Loss = 0.0010, Val F1 = 0.3717
Epoch 42 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000831]
Epoch 42 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.19it/s]
Val Metrics - F1: 0.4483 | Precision: 0.3410 | Recall: 0.7313
Epoch 42: Train Loss = 0.0010, Val F1 = 0.4483
Epoch 43 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00107]
Epoch 43 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.21it/s]
Val Metrics - F1: 0.4633 | Precision: 0.3658 | Recall: 0.7090
Epoch 43: Train Loss = 0.0009, Val F1 = 0.4633
Epoch 44 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000796]
Epoch 44 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.4838 | Precision: 0.3768 | Recall: 0.7254
Epoch 44: Train Loss = 0.0009, Val F1 = 0.4838
Epoch 45 [Train]: 100%|███████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.001]
Epoch 45 [Val]: 100%|█████████████████████████| 275/275 [00:34<00:00,  8.07it/s]
Val Metrics - F1: 0.4556 | Precision: 0.3511 | Recall: 0.7423
Epoch 45: Train Loss = 0.0009, Val F1 = 0.4556
Epoch 46 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000948]
Epoch 46 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.25it/s]
Val Metrics - F1: 0.4494 | Precision: 0.3447 | Recall: 0.7396
Epoch 46: Train Loss = 0.0009, Val F1 = 0.4494
Epoch 47 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000962]
Epoch 47 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.20it/s]
Val Metrics - F1: 0.5052 | Precision: 0.4058 | Recall: 0.7404
Epoch 47: Train Loss = 0.0008, Val F1 = 0.5052
Epoch 48 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.00133]
Epoch 48 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.4658 | Precision: 0.3529 | Recall: 0.7516
Epoch 48: Train Loss = 0.0008, Val F1 = 0.4658
Epoch 49 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000762]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 49 [Val]: 100%|█████████████████████████| 275/275 [00:40<00:00,  6.79it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.5596
Prediction Stats - Mean Prob: 0.001032, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 49: Train Loss = 0.0008, Val F1 = 0.3590
Epoch 50 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000941]
Epoch 50 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.4719 | Precision: 0.3789 | Recall: 0.7090
Epoch 50: Train Loss = 0.0009, Val F1 = 0.4719
Epoch 51 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000635]
Epoch 51 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.15it/s]
Val Metrics - F1: 0.5054 | Precision: 0.4088 | Recall: 0.7394
Epoch 51: Train Loss = 0.0009, Val F1 = 0.5054
Epoch 52 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000764]
Epoch 52 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.31it/s]
Val Metrics - F1: 0.5012 | Precision: 0.3957 | Recall: 0.7474
Epoch 52: Train Loss = 0.0007, Val F1 = 0.5012
Epoch 53 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00132]
Epoch 53 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.4974 | Precision: 0.3848 | Recall: 0.7670
Epoch 53: Train Loss = 0.0008, Val F1 = 0.4974
Epoch 54 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000543]
Epoch 54 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.29it/s]
Val Metrics - F1: 0.5209 | Precision: 0.4211 | Recall: 0.7449
Epoch 54: Train Loss = 0.0007, Val F1 = 0.5209
Epoch 55 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.00058]
Epoch 55 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.5253 | Precision: 0.4210 | Recall: 0.7606
Epoch 55: Train Loss = 0.0006, Val F1 = 0.5253
Epoch 56 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000606]
Epoch 56 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.31it/s]
Val Metrics - F1: 0.5183 | Precision: 0.4127 | Recall: 0.7668
Epoch 56: Train Loss = 0.0006, Val F1 = 0.5183
Epoch 57 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000525]
Epoch 57 [Val]: 100%|█████████████████████████| 275/275 [00:43<00:00,  6.38it/s]
Val Metrics - F1: 0.5169 | Precision: 0.4079 | Recall: 0.7616
Epoch 57: Train Loss = 0.0006, Val F1 = 0.5169
Epoch 58 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000677]
Epoch 58 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.28it/s]
Val Metrics - F1: 0.4992 | Precision: 0.4032 | Recall: 0.7321
Epoch 58: Train Loss = 0.0006, Val F1 = 0.4992
Epoch 59 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000872]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 59 [Val]: 100%|█████████████████████████| 275/275 [00:39<00:00,  6.98it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.5863
Prediction Stats - Mean Prob: 0.000889, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 59: Train Loss = 0.0006, Val F1 = 0.3783
Epoch 60 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000681]
Epoch 60 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.23it/s]
Val Metrics - F1: 0.5208 | Precision: 0.4094 | Recall: 0.7752
Epoch 60: Train Loss = 0.0006, Val F1 = 0.5208
Epoch 61 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00062]
Epoch 61 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.31it/s]
Val Metrics - F1: 0.4907 | Precision: 0.3750 | Recall: 0.7780
Epoch 61: Train Loss = 0.0007, Val F1 = 0.4907
Epoch 62 [Train]: 100%|██████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.0008]
Epoch 62 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.5309 | Precision: 0.4240 | Recall: 0.7636
Epoch 62: Train Loss = 0.0031, Val F1 = 0.5309
Epoch 63 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000456]
Epoch 63 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.5673 | Precision: 0.4577 | Recall: 0.7879
Epoch 63: Train Loss = 0.0005, Val F1 = 0.5673
Epoch 64 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000384]
Epoch 64 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.5958 | Precision: 0.4948 | Recall: 0.7905
Epoch 64: Train Loss = 0.0004, Val F1 = 0.5958
Epoch 65 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.00034]
Epoch 65 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.6128 | Precision: 0.5139 | Recall: 0.7893
Epoch 65: Train Loss = 0.0004, Val F1 = 0.6128
Epoch 66 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000362]
Epoch 66 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.29it/s]
Val Metrics - F1: 0.6127 | Precision: 0.5146 | Recall: 0.7940
Epoch 66: Train Loss = 0.0004, Val F1 = 0.6127
Epoch 67 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000354]
Epoch 67 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.29it/s]
Val Metrics - F1: 0.6209 | Precision: 0.5261 | Recall: 0.7942
Epoch 67: Train Loss = 0.0003, Val F1 = 0.6209
Epoch 68 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00036]
Epoch 68 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.28it/s]
Val Metrics - F1: 0.6117 | Precision: 0.5126 | Recall: 0.7965
Epoch 68: Train Loss = 0.0003, Val F1 = 0.6117
Epoch 69 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000419]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 69 [Val]: 100%|█████████████████████████| 275/275 [00:39<00:00,  6.93it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.6724
Prediction Stats - Mean Prob: 0.000614, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 69: Train Loss = 0.0003, Val F1 = 0.4385
Epoch 70 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000389]
Epoch 70 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.26it/s]
Val Metrics - F1: 0.6217 | Precision: 0.5221 | Recall: 0.7966
Epoch 70: Train Loss = 0.0003, Val F1 = 0.6217
Epoch 71 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000468]
Epoch 71 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.6205 | Precision: 0.5271 | Recall: 0.7874
Epoch 71: Train Loss = 0.0004, Val F1 = 0.6205
Epoch 72 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000679]
Epoch 72 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.14it/s]
Val Metrics - F1: 0.5789 | Precision: 0.4764 | Recall: 0.7847
Epoch 72: Train Loss = 0.0004, Val F1 = 0.5789
Epoch 73 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.00128]
Epoch 73 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.17it/s]
Val Metrics - F1: 0.4218 | Precision: 0.3194 | Recall: 0.7227
Epoch 73: Train Loss = 0.0006, Val F1 = 0.4218
Epoch 74 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000392]
Epoch 74 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.22it/s]
Val Metrics - F1: 0.5814 | Precision: 0.4799 | Recall: 0.7854
Epoch 74: Train Loss = 0.0008, Val F1 = 0.5814
Epoch 75 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000333]
Epoch 75 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.14it/s]
Val Metrics - F1: 0.6275 | Precision: 0.5315 | Recall: 0.7927
Epoch 75: Train Loss = 0.0004, Val F1 = 0.6275
Epoch 76 [Train]: 100%|████████| 315/315 [01:17<00:00,  4.09it/s, loss=0.000326]
Epoch 76 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.17it/s]
Val Metrics - F1: 0.6319 | Precision: 0.5381 | Recall: 0.7976
Epoch 76: Train Loss = 0.0003, Val F1 = 0.6319
Epoch 77 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000349]
Epoch 77 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.20it/s]
Val Metrics - F1: 0.6456 | Precision: 0.5553 | Recall: 0.7980
Epoch 77: Train Loss = 0.0003, Val F1 = 0.6456
Epoch 78 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000257]
Epoch 78 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.6584 | Precision: 0.5760 | Recall: 0.7944
Epoch 78: Train Loss = 0.0003, Val F1 = 0.6584
Epoch 79 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000383]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 79 [Val]: 100%|█████████████████████████| 275/275 [00:39<00:00,  7.02it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.6850
Prediction Stats - Mean Prob: 0.000519, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 79: Train Loss = 0.0003, Val F1 = 0.4480
Epoch 80 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000334]
Epoch 80 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.6621 | Precision: 0.5832 | Recall: 0.7867
Epoch 80: Train Loss = 0.0003, Val F1 = 0.6621
Epoch 81 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000562]
Epoch 81 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.5326 | Precision: 0.4218 | Recall: 0.7887
Epoch 81: Train Loss = 0.0004, Val F1 = 0.5326
Epoch 82 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000701]
Epoch 82 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.29it/s]
Val Metrics - F1: 0.5737 | Precision: 0.4787 | Recall: 0.7772
Epoch 82: Train Loss = 0.0005, Val F1 = 0.5737
Epoch 83 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000805]
Epoch 83 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.5509 | Precision: 0.4447 | Recall: 0.7773
Epoch 83: Train Loss = 0.0005, Val F1 = 0.5509
Epoch 84 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000286]
Epoch 84 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.23it/s]
Val Metrics - F1: 0.6527 | Precision: 0.5705 | Recall: 0.7913
Epoch 84: Train Loss = 0.0004, Val F1 = 0.6527
Epoch 85 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000279]
Epoch 85 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.21it/s]
Val Metrics - F1: 0.6635 | Precision: 0.5801 | Recall: 0.7957
Epoch 85: Train Loss = 0.0003, Val F1 = 0.6635
Epoch 86 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000323]
Epoch 86 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.25it/s]
Val Metrics - F1: 0.6512 | Precision: 0.5625 | Recall: 0.7969
Epoch 86: Train Loss = 0.0003, Val F1 = 0.6512
Epoch 87 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.00031]
Epoch 87 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.22it/s]
Val Metrics - F1: 0.6729 | Precision: 0.5942 | Recall: 0.7958
Epoch 87: Train Loss = 0.0003, Val F1 = 0.6729
Epoch 88 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000409]
Epoch 88 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.26it/s]
Val Metrics - F1: 0.6273 | Precision: 0.5342 | Recall: 0.7948
Epoch 88: Train Loss = 0.0003, Val F1 = 0.6273
Epoch 89 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000345]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 89 [Val]: 100%|█████████████████████████| 275/275 [00:39<00:00,  7.00it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.6980
Prediction Stats - Mean Prob: 0.000505, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 89: Train Loss = 0.0003, Val F1 = 0.4604
Epoch 90 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000355]
Epoch 90 [Val]: 100%|█████████████████████████| 275/275 [00:34<00:00,  8.03it/s]
Val Metrics - F1: 0.6044 | Precision: 0.5109 | Recall: 0.7979
Epoch 90: Train Loss = 0.0003, Val F1 = 0.6044
Epoch 91 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000356]
Epoch 91 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.6546 | Precision: 0.5686 | Recall: 0.7996
Epoch 91: Train Loss = 0.0003, Val F1 = 0.6546
Epoch 92 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000258]
Epoch 92 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.6732 | Precision: 0.5936 | Recall: 0.7967
Epoch 92: Train Loss = 0.0003, Val F1 = 0.6732
Epoch 93 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000278]
Epoch 93 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.26it/s]
Val Metrics - F1: 0.6614 | Precision: 0.5799 | Recall: 0.7946
Epoch 93: Train Loss = 0.0003, Val F1 = 0.6614
Epoch 94 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.11it/s, loss=0.00054]
Epoch 94 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.6226 | Precision: 0.5409 | Recall: 0.7689
Epoch 94: Train Loss = 0.0004, Val F1 = 0.6226
Epoch 95 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000238]
Epoch 95 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.32it/s]
Val Metrics - F1: 0.6645 | Precision: 0.5885 | Recall: 0.7975
Epoch 95: Train Loss = 0.0003, Val F1 = 0.6645
Epoch 96 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000274]
Epoch 96 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.25it/s]
Val Metrics - F1: 0.6829 | Precision: 0.6083 | Recall: 0.8006
Epoch 96: Train Loss = 0.0002, Val F1 = 0.6829
Epoch 97 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00021]
Epoch 97 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.32it/s]
Val Metrics - F1: 0.6830 | Precision: 0.6046 | Recall: 0.8017
Epoch 97: Train Loss = 0.0002, Val F1 = 0.6830
Epoch 98 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000159]
Epoch 98 [Val]: 100%|█████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.6918 | Precision: 0.6195 | Recall: 0.7992
Epoch 98: Train Loss = 0.0002, Val F1 = 0.6918
Epoch 99 [Train]: 100%|█████████| 315/315 [01:16<00:00,  4.13it/s, loss=0.00026]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 99 [Val]: 100%|█████████████████████████| 275/275 [00:39<00:00,  7.00it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7225
Prediction Stats - Mean Prob: 0.000443, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 99: Train Loss = 0.0002, Val F1 = 0.4807
Epoch 100 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000169]
Epoch 100 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.28it/s]
Val Metrics - F1: 0.7023 | Precision: 0.6343 | Recall: 0.8017
Epoch 100: Train Loss = 0.0002, Val F1 = 0.7023
Epoch 101 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.13it/s, loss=0.000216]
Epoch 101 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.6806 | Precision: 0.6043 | Recall: 0.8002
Epoch 101: Train Loss = 0.0003, Val F1 = 0.6806
Epoch 102 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000153]
Epoch 102 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.27it/s]
Val Metrics - F1: 0.7083 | Precision: 0.6421 | Recall: 0.8022
Epoch 102: Train Loss = 0.0002, Val F1 = 0.7083
Epoch 103 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000255]
Epoch 103 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.16it/s]
Val Metrics - F1: 0.6907 | Precision: 0.6242 | Recall: 0.8010
Epoch 103: Train Loss = 0.0002, Val F1 = 0.6907
Epoch 104 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000169]
Epoch 104 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.26it/s]
Val Metrics - F1: 0.6954 | Precision: 0.6263 | Recall: 0.8026
Epoch 104: Train Loss = 0.0002, Val F1 = 0.6954
Epoch 105 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000211]
Epoch 105 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.31it/s]
Val Metrics - F1: 0.6889 | Precision: 0.6209 | Recall: 0.8001
Epoch 105: Train Loss = 0.0002, Val F1 = 0.6889
Epoch 106 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000157]
Epoch 106 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.24it/s]
Val Metrics - F1: 0.6953 | Precision: 0.6245 | Recall: 0.8015
Epoch 106: Train Loss = 0.0002, Val F1 = 0.6953
Epoch 107 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000192]
Epoch 107 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.30it/s]
Val Metrics - F1: 0.6781 | Precision: 0.6033 | Recall: 0.8037
Epoch 107: Train Loss = 0.0002, Val F1 = 0.6781
Epoch 108 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000169]
Epoch 108 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.28it/s]
Val Metrics - F1: 0.6761 | Precision: 0.5985 | Recall: 0.8009
Epoch 108: Train Loss = 0.0004, Val F1 = 0.6761
Epoch 109 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000147]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 109 [Val]: 100%|████████████████████████| 275/275 [00:38<00:00,  7.08it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7445
Prediction Stats - Mean Prob: 0.000372, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 109: Train Loss = 0.0002, Val F1 = 0.4966
Epoch 110 [Train]: 100%|███████| 315/315 [01:17<00:00,  4.09it/s, loss=0.000178]
Epoch 110 [Val]: 100%|████████████████████████| 275/275 [00:34<00:00,  8.08it/s]
Val Metrics - F1: 0.7291 | Precision: 0.6736 | Recall: 0.8035
Epoch 110: Train Loss = 0.0001, Val F1 = 0.7291
Epoch 111 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000115]
Epoch 111 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.10it/s]
Val Metrics - F1: 0.7211 | Precision: 0.6603 | Recall: 0.8042
Epoch 111: Train Loss = 0.0001, Val F1 = 0.7211
Epoch 112 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000136]
Epoch 112 [Val]: 100%|████████████████████████| 275/275 [00:34<00:00,  8.08it/s]
Val Metrics - F1: 0.7372 | Precision: 0.6878 | Recall: 0.8012
Epoch 112: Train Loss = 0.0001, Val F1 = 0.7372
Epoch 113 [Train]: 100%|███████| 315/315 [01:17<00:00,  4.09it/s, loss=0.000134]
Epoch 113 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.13it/s]
Val Metrics - F1: 0.7330 | Precision: 0.6798 | Recall: 0.8028
Epoch 113: Train Loss = 0.0001, Val F1 = 0.7330
Epoch 114 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.09it/s, loss=0.000103]
Epoch 114 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.13it/s]
Val Metrics - F1: 0.7262 | Precision: 0.6703 | Recall: 0.8032
Epoch 114: Train Loss = 0.0001, Val F1 = 0.7262
Epoch 115 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000141]
Epoch 115 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.25it/s]
Val Metrics - F1: 0.7245 | Precision: 0.6673 | Recall: 0.8045
Epoch 115: Train Loss = 0.0001, Val F1 = 0.7245
Epoch 116 [Train]: 100%|███████| 315/315 [01:17<00:00,  4.09it/s, loss=0.000294]
Epoch 116 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.10it/s]
Val Metrics - F1: 0.6795 | Precision: 0.6050 | Recall: 0.7958
Epoch 116: Train Loss = 0.0003, Val F1 = 0.6795
Epoch 117 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000179]
Epoch 117 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.20it/s]
Val Metrics - F1: 0.7327 | Precision: 0.6788 | Recall: 0.8036
Epoch 117: Train Loss = 0.0002, Val F1 = 0.7327
Epoch 118 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.11it/s, loss=0.000124]
Epoch 118 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.13it/s]
Val Metrics - F1: 0.7370 | Precision: 0.6862 | Recall: 0.8041
Epoch 118: Train Loss = 0.0001, Val F1 = 0.7370
Epoch 119 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.09it/s, loss=0.000116]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 119 [Val]: 100%|████████████████████████| 275/275 [00:40<00:00,  6.79it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7606
Prediction Stats - Mean Prob: 0.000344, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 119: Train Loss = 0.0001, Val F1 = 0.5108
Epoch 120 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.09it/s, loss=0.000122]
Epoch 120 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.12it/s]
Val Metrics - F1: 0.7409 | Precision: 0.6923 | Recall: 0.8048
Epoch 120: Train Loss = 0.0001, Val F1 = 0.7409
Epoch 121 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.09it/s, loss=0.000161]
Epoch 121 [Val]: 100%|████████████████████████| 275/275 [00:34<00:00,  8.05it/s]
Val Metrics - F1: 0.7377 | Precision: 0.6860 | Recall: 0.8055
Epoch 121: Train Loss = 0.0001, Val F1 = 0.7377
Epoch 122 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000104]
Epoch 122 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.18it/s]
Val Metrics - F1: 0.7480 | Precision: 0.7046 | Recall: 0.8035
Epoch 122: Train Loss = 0.0001, Val F1 = 0.7480
Epoch 123 [Train]: 100%|████████| 315/315 [01:17<00:00,  4.09it/s, loss=9.42e-5]
Epoch 123 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.18it/s]
Val Metrics - F1: 0.7433 | Precision: 0.6978 | Recall: 0.8034
Epoch 123: Train Loss = 0.0001, Val F1 = 0.7433
Epoch 124 [Train]: 100%|███████| 315/315 [01:17<00:00,  4.08it/s, loss=0.000148]
Epoch 124 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.32it/s]
Val Metrics - F1: 0.7178 | Precision: 0.6676 | Recall: 0.7967
Epoch 124: Train Loss = 0.0001, Val F1 = 0.7178
Epoch 125 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.10it/s, loss=9.35e-5]
Epoch 125 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.35it/s]
Val Metrics - F1: 0.7414 | Precision: 0.6926 | Recall: 0.8042
Epoch 125: Train Loss = 0.0002, Val F1 = 0.7414
Epoch 126 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.11it/s, loss=9.54e-5]
Epoch 126 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.34it/s]
Val Metrics - F1: 0.7445 | Precision: 0.6967 | Recall: 0.8062
Epoch 126: Train Loss = 0.0001, Val F1 = 0.7445
Epoch 127 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.10it/s, loss=0.000293]
Epoch 127 [Val]: 100%|████████████████████████| 275/275 [00:33<00:00,  8.32it/s]
Val Metrics - F1: 0.6934 | Precision: 0.6260 | Recall: 0.8015
Epoch 127: Train Loss = 0.0001, Val F1 = 0.6934
Epoch 128 [Train]: 100%|████████| 315/315 [01:16<00:00,  4.12it/s, loss=9.66e-5]
Epoch 128 [Val]: 100%|████████████████████████| 275/275 [00:32<00:00,  8.33it/s]
Val Metrics - F1: 0.7451 | Precision: 0.6987 | Recall: 0.8051
Epoch 128: Train Loss = 0.0001, Val F1 = 0.7451
Epoch 129 [Train]: 100%|███████| 315/315 [01:16<00:00,  4.12it/s, loss=0.000121]
Note: Applying temporal smoothing per batch during validation to save memory.
Epoch 129 [Val]: 100%|████████████████████████| 275/275 [00:38<00:00,  7.12it/s]

[Post-Processing] Concatenating predictions (Memory-efficient)...
Applying temporal smoothing (method: ema) chunk-wise to save memory...
[Post-Processing] Masking invalid frames...
Optimizing thresholds using 8 jobs...
Thresholds optimized for 21 labs. Mean Best F1 (Internal): 0.7674
Prediction Stats - Mean Prob: 0.000332, Max Prob: 1.000000
Applying tie-breaking (method: z_score) using 8 jobs...
[Post-Processing] Applying Active Label Masking to final predictions...
Calculating F1 scores using Vectorized Logic (Official MABe Style)...
Epoch 129: Train Loss = 0.0001, Val F1 = 0.5155
Early stopping: Train loss 0.000098 reached threshold 0.0001

