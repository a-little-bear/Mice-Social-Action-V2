experiment_name: "Advanced_HHSTF_Maxed"

seed: 42
debug: false
test: false

# Path Settings
# For Linux/AutoDL, use absolute paths to data disk (e.g., /root/autodl-tmp/...)
data:
  data_dir: "data/" # Path to the directory containing train.csv and tracking/annotation folders
  batch_size: 2048 # Increased to 2048 to fill GPU.
  num_workers: 16 # Increased to 16 to feed the GPU.
  window_size: 512
  preload: true # Enabled! Data is only 2.63GB, safe to load into RAM.
  pin_memory: true
  prefetch_factor: 2
  persistent_workers: true
  cache_size: 8 # Ignored when preload is true.
  
  sampling:
    strategy: "action_rich" # Options: "uniform", "action_rich" (oversample rare classes)
    bias_factor: 20.0

  preprocessing:
    target_fps: 30
    fix_fps: true
    interpolate_nans: true
    unify_body_parts: true
    view: "egocentric" # Options: "allocentric", "egocentric" (mouse-centered)
    
  features:
    enable_strong_features: true
    use_distances: true
    use_velocity: true
    use_acceleration: true
    use_jerk: true # Enabled. Fast on GPU.
    use_angles: true
    use_relative_angles: true
    use_window_stats: false
    window_sizes: [5, 15, 30]

  augmentation:
    enabled: true
    flip: true
    rotate: true
    time_stretch: false
    noise: 0.01

model:
  spatial_encoder:
    enabled: true
    type: "st_gcn" # Options: "gat" (Graph Attention), "st_gcn" (Spatio-Temporal GCN), "identity"
    hidden_dim: 64
    num_layers: 2
    dropout: 0.1
    
  temporal_backbone:
    type: "squeezeformer" # Options: "squeezeformer" (Attention+Conv), "wavenet" (Dilated Conv), "transformer", "multi_scale_cnn"
    input_dim: 0 # Will be set dynamically in train.py
    hidden_dim: 128
    num_layers: 4
    kernel_size: 3
    dropout: 0.2
    
  fusion:
    type: "attention" # Options: "attention" (Weighted Sum), "concat" (Concatenation), "gated"
    hidden_dim: 256
    
  classifier:
    num_classes: 76 # Interaction, Investigation, Other
    hidden_dim: 128
    
  context_adapter:
    enabled: true
    embedding_dim: 16

training:
  optimizer: "fused_adamw"
  epochs: 50
  learning_rate: 0.001
  weight_decay: 0.0001
  scheduler: "cosine" # Options: "cosine", "step", "plateau"
  loss_type: "focal" # Options: "focal", "ce", "bce", "ohem", "macro_soft_f1"
  pos_weight: 10.0 # Weight for positive class in BCE
  ohem_percent: 0.7 # For OHEM loss
  mask_unlabeled: true
  save_dir: "/root/autodl-tmp/checkpoints/" #"checkpoints/" # Directory to save model weights and metrics
  torch_compile: false # Disable to save memory during startup and avoid compilation overhead

cross_validation:
  enabled: true
  n_folds: 5

post_processing:
  optimize_thresholds: true
  tie_breaking: "z_score" # Options: "none", "z_score", "argmax"
  smoothing:
    method: "median_filter" # Options: "median_filter", "ema", "none"
    window_size: 7
    alpha: 0.3 # For EMA
  gap_filling:
    max_gap: 10
    min_duration: 5


