experiment_name: "Advanced_HHSTF_Maxed"

seed: 42
debug: false
test: false

data:
  data_dir: "data/"
  batch_size: 4096
  num_workers: 4
  window_size: 512
  preload: true
  pin_memory: true
  prefetch_factor: 2
  persistent_workers: true
  cache_size: 1000
  
  sampling:
    strategy: "uniform" # Options: "uniform", "action_rich" (oversample rare classes)
    bias_factor: 0.6

  preprocessing:
    target_fps: 30
    fix_fps: true
    interpolate_nans: true
    unify_body_parts: true
    view: "egocentric" # Options: "allocentric", "egocentric" (mouse-centered)
    
  features:
    enable_strong_features: true
    use_distances: true
    use_velocity: true
    use_acceleration: true
    use_jerk: true
    use_angles: true
    use_window_stats: true
    window_sizes: [5, 15, 30]

  augmentation:
    enabled: true
    flip: true
    rotate: true
    time_stretch: true
    noise: 0.01

model:
  spatial_encoder:
    enabled: true
    type: "st_gcn" # Options: "gat" (Graph Attention), "st_gcn" (Spatio-Temporal GCN), "identity"
    hidden_dim: 64
    num_layers: 2
    dropout: 0.1
    
  temporal_backbone:
    type: "squeezeformer" # Options: "squeezeformer" (Attention+Conv), "wavenet" (Dilated Conv), "transformer", "multi_scale_cnn"
    input_dim: 0 # Will be set dynamically in train.py
    hidden_dim: 128
    num_layers: 4
    kernel_size: 3
    dropout: 0.2
    
  fusion:
    type: "attention" # Options: "attention" (Weighted Sum), "concat" (Concatenation), "gated"
    hidden_dim: 256
    
  classifier:
    num_classes: 3 # Interaction, Investigation, Other
    hidden_dim: 128
    
  context_adapter:
    enabled: true
    embedding_dim: 16

training:
  optimizer: "fused_adamw"
  epochs: 50
  learning_rate: 0.001
  weight_decay: 0.0001
  scheduler: "cosine" # Options: "cosine", "step", "plateau"
  loss_type: "focal" # Options: "focal" (Class Imbalance), "ce" (Cross Entropy)
  mask_unlabeled: true
  save_dir: "checkpoints/"

cross_validation:
  enabled: true
  n_folds: 5

post_processing:
  optimize_thresholds: false
  smoothing:
    method: "median_filter" # Options: "median_filter", "ema", "none"
    window_size: 7
    alpha: 0.3 # For EMA
  gap_filling:
    max_gap: 10
    min_duration: 5
  tie_breaking: "none" # Options: "z_score", "none"


